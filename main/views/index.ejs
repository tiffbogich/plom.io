<% include layout %>

<a href="https://github.com/plom"><img style="position:absolute; top:42px; right:0;  border: 0;" src="images/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>

<div class="row">

  <div class="span5" style="background:url(images/logo-large.png) no-repeat right center; background-size: auto 80px;">
    <h1>PLoM.io</h1>
    <p class="sfr-brand"> Public Library of Models</p>
  </div>

</div>


<section>


  <form>
    <div class="input-append">
      <input type="text" name="q" class="input-xlarge"/>
      <button type="submit" class="btn">Search</button>
    </div>
  </form>

  <div class="app-folders-container"> 


    <!-- the contexts -->
    <% ctree.forEach(function(c, i){ %>

    <% if ( (i%3) === 0 ){ %>
    <div class="jaf-row jaf-container">
    <% } %>

    <div class="folder context-box" id="<%= c._id %>">

      <a href="#"><%= c.disease.join('; ') + ' / ' + c.name %></a>

      <ul>
        <li><%= c.model.length %> model<%= (c.model.length > 1) ? 's': '' %></li>
        <li><%= (c.contributor && c.contributor.length) || 0 %> contributor<%= (c.contributor && (c.contributor.length > 1)) ? 's': '' %></li>
      </ul>

      <!-- placeholder for timeseries plot -->
      <div id="graphdiv<%= i %>" class="context-graph"></div>

      <select id="ts-picker-<%= i %>"  class="ts-picker">
        <option value="-1">All time series</option>
        <% c.time_series.forEach(function(ts, indts){ %>
        <option value="<%= indts %>"><%= ts.id.split('__').join('; ') %></option>
        <% }); %>
      </select>
    </div>

    <% if (((i+1) %3) === 0  || i === 4){ %>
    </div>
    <% } %>
    <% }); %>

    <!-- the models -->
    <% ctree.forEach(function(c, i){ %>
    <div class="folderContent <%= c._id %>">
      <div class="jaf-container">        

        <div class="horizontal-scroll">
          <% c.model.forEach(function(m, j){ %>
          <div class="model-box">
            
            <a href="#"><%= m.process.name + ' / ' + m.link.name   %></a>

            <!-- placeholder for d3 viz of compartmental model -->
            <div id="pgraph<%= m.process._id %>" class="process-graph"></div>
            
            <div>score: <%= m.theta && m.theta.score %></div>
            
            <div class="parameter-box">
                <% if (m.theta && m.theta.values) { %>
                   <ul>                     
                     <% for (var par in m.theta.values) { %>
                     <li>
                       <%= par %>:
                       <ul>
                         <% for (var group in m.theta.values[par]) { %>
                         <li><%= group %> = <%= m.theta.values[par][group] %> </li>                   
                         <% }; %>
                       </ul>
                     </li>
                     <% }; %>
                   </ul>
                <% }; %>
            </div>

          </div>
          <% }); %>
        </div>
      </div>
      <% }); %>
    </div>

  </div>


</section>



<% include footer %>
